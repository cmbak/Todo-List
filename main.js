(()=>{"use strict";class e{constructor(e){this.projectName=e,this.todos=[]}static addTodo=(e,t)=>{e.todos.push(t)};static removeTodo=(e,t)=>{e.todos=e.todos.filter((e=>e.title!=t))};static todoExists=(e,t)=>{for(const o of e.todos)if(o.title==t)return!0;return!1}}const t=()=>null!==localStorage.getItem("projects")&&localStorage.getItem("projects").length>0,o=()=>{if(t())return JSON.parse(localStorage.getItem("projects")).map((e=>e.projectName))},n=e=>JSON.parse(localStorage.getItem("projects")).find((t=>t.projectName==e)),d=e=>{const t=JSON.parse(localStorage.getItem("projects"));t.forEach((o=>{o.projectName==e.projectName&&(t[t.indexOf(o)]=e)})),localStorage.setItem("projects",JSON.stringify(t))};class r{constructor(e,t,o,n){this.title=e,this.description=t,this.dueDate=o,this.priority=n,this.completed=!1}}document.getElementById("cancel").addEventListener("click",s);const a=document.getElementById("create-project-btn");a.addEventListener("click",(e=>{e.preventDefault(),s()})),document.getElementById("add-project-btn").addEventListener("click",(()=>{const n=document.getElementById("project-input").value;return""==n?(alert("Sorry, please enter a valid project name"),!1):(e=>!!t()&&o().includes(e))(n)?(alert("Sorry, a project with that name already exists!"),!1):(s(),(o=>{if(t()){let t=JSON.parse(localStorage.getItem("projects"));t.push(new e(o)),localStorage.setItem("projects",JSON.stringify(t))}else localStorage.setItem("projects",JSON.stringify([new e(o)]))})(n),void u(n))}));const c=t=>{const o=(e=>{let t;return JSON.parse(localStorage.getItem("projects")).forEach((o=>{o.projectName==e&&(t=o.todos)})),t})(t),n=document.getElementById("todos");n.innerHTML="",o.forEach((o=>{const r=document.createElement("div"),a=document.createElement("button");r.classList.add("todo-item"),a.innerText="Delete Todo",a.classList.add("delete-todo-btn"),a.addEventListener("click",(()=>{((t,o)=>{const n=JSON.parse(localStorage.getItem("projects"));for(const r of n)if(r.projectName==t)return e.removeTodo(r,o),void d(r)})(t,o.title),c(t)})),r.innerHTML=`\n            <h3 class="todo-title priority-${o.priority}">${o.title}</h3>\n            <p class="todo-desc">${o.description}</p>\n            <p class="todo-date">Due: ${o.dueDate}</p>\n        `,r.appendChild(a),n.appendChild(r)}))},l=()=>{if(t()){const e=o();i(),e.forEach((e=>{u(e)}))}},i=()=>{const e=document.getElementById("projects");for(;e.firstChild;)e.removeChild(e.firstChild)};function s(){m(),p()}const m=()=>{a.classList.toggle("hidden")},p=()=>{document.getElementById("add-project-form").classList.toggle("hidden"),document.getElementById("project-input").value=""},u=e=>{const t=document.getElementById("projects"),o=document.createElement("li"),n=document.createElement("button"),d=document.createElement("div"),r=document.createTextNode(e);e==localStorage.getItem("activeProject")&&f(e,n),n.classList.add("project-name-btn"),n.addEventListener("click",(()=>f(e,n))),o.classList.add("project-name"),o.appendChild(n),d.classList.add("project-container"),d.appendChild(o),d.appendChild(g(e)),n.appendChild(r),t.appendChild(d)},g=e=>{const o=document.createElement("form"),n=document.createElement("button");return o.appendChild(n),n.innerText="Delete",n.value=e,n.classList.add("delete-project-btn"),n.addEventListener("click",(o=>{o.preventDefault(),(e=>{if(t()){const t=JSON.parse(localStorage.getItem("projects")).filter((t=>t.projectName!=e));localStorage.setItem("projects",JSON.stringify(t))}})(e),h(),document.getElementById("todo-container").innerHTML="",l()})),o},f=(e,t)=>{h(),t.classList.toggle("active-project"),E(e),(e=>{localStorage.setItem("activeProject",e)})(e),c(e)},h=()=>{Array.prototype.forEach.call(document.getElementsByClassName("project-name-btn"),(e=>{e.classList.remove("active-project")}))},E=t=>{document.getElementById("todo-container").innerHTML=`\n        <div id="todos"></div>\n        <button id="create-todo-btn">Create Todo</button>\n        <form id="create-todo-form" class="hidden">\n            <label for="todo-form-title">Todo Name</label>\n            <input type="text" name="title" id="todo-form-title" placeholder="Name of todo" required>\n            <label for="todo-form-desc">Description</label>\n            <textarea name="desc" id="todo-form-desc" cols="30" rows="10" placeholder="Optional description..."></textarea>\n            <label for="todo-priority">Priority</label>\n            <select name="priority" id="todo-priority" required>\n                <option value="low">Low</option>\n                <option value="medium">Medium</option>\n                <option value="high">High</option>\n            </select>\n            <label for="todo-date-input">Due Date</label>\n            <input type="date" name="due-date" id="todo-date-input" required>\n            <button type="submit" id="add-todo-btn" value="${t}">Create Todo</button>\n            <button id="add-todo-cancel-btn" class="delete-todo-btn">Cancel</button>\n        </form>\n    `;const o=document.getElementById("create-todo-form");o.addEventListener("submit",(a=>{if(a.preventDefault(),e.todoExists(n(t),new FormData(o).get("title")))return alert("Sorry, a todo with this name already exists!"),!1;((t,o)=>{const a=new FormData(t);((t,o)=>{const r=n(o);e.addTodo(r,t),d(r)})(new r(a.get("title"),a.get("desc"),a.get("due-date"),a.get("priority")),o)})(o,t),c(t),o.reset(),j()})),document.getElementById("create-todo-btn").addEventListener("click",(e=>{e.preventDefault(),j()})),document.getElementById("add-todo-cancel-btn").addEventListener("click",(e=>{e.preventDefault(),j()}))},j=()=>{const e=document.getElementById("create-todo-btn"),t=document.getElementById("create-todo-form");e.classList.toggle("hidden"),t.classList.toggle("hidden")};l()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YyxPQUFPLFVBQy9CcUIsRUFBZW5DLFVBQVVjLE9BQU8sU0FBUyxFRTVON0NQLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvcHJvamVjdC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvcHJvamVjdF9scy5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvdG9kby5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvVUkuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3RvZG9fbHMuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcclxuICAgIGNvbnN0cnVjdG9yKHByb2plY3ROYW1lKSB7XHJcbiAgICAgICAgdGhpcy5wcm9qZWN0TmFtZSA9IHByb2plY3ROYW1lO1xyXG4gICAgICAgIHRoaXMudG9kb3MgPSBbXTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBZGRzIGEgdG9kbyB0byB0aGUgcHJvamVjdFxyXG4gICAgc3RhdGljIGFkZFRvZG8gPSAocHJvaiwgdG9kbykgPT4ge1xyXG4gICAgICAgIHByb2oudG9kb3MucHVzaCh0b2RvKTtcclxuICAgIH1cclxuICAgIC8vIFJlbW92ZXMgYSB0b2RvIHdpdGggYSBnaXZlbiBuYW1lXHJcbiAgICBzdGF0aWMgcmVtb3ZlVG9kbyA9IChwcm9qLCB0b2RvTmFtZSkgPT4ge1xyXG4gICAgICAgIHByb2oudG9kb3MgPSBwcm9qLnRvZG9zLmZpbHRlcigodG9kbykgPT4gdG9kby50aXRsZSAhPSB0b2RvTmFtZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJucyB0cnVlL2ZhbHNlIGRlcGVuZGluZyBvbiBpZiBhIHRvZG8gYWxyZWFkeSBleGlzdHMgd2l0aCB0aGUgc2FtZSBuYW1lXHJcbiAgICBzdGF0aWMgdG9kb0V4aXN0cyA9IChwcm9qLCB0b2RvTmFtZSkgPT4ge1xyXG4gICAgICAgIGZvcihjb25zdCB0b2RvIG9mIHByb2oudG9kb3MpIHtcclxuICAgICAgICAgICAgaWYgKHRvZG8udGl0bGUgPT0gdG9kb05hbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufSIsImltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi9wcm9qZWN0XCI7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvamVjdHNFeGlzdHMgPSAoKSA9PiB7XHJcbiAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c1wiKSAhPT0gbnVsbCAmJiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInByb2plY3RzXCIpLmxlbmd0aCA+IDA7IC8vIGlzIHJpZ2h0IGNvbmRpdGlvbiB2YWxpZD9cclxufVxyXG5cclxuLy8gQWRkcyBuZXcgcHJvamVjdCB0byBsb2NhbCBzdG9yYWdlIGFuZCBkaXNwbGF5cyBpdCBpbiBwcm9qZWN0IHRhYlxyXG5leHBvcnQgY29uc3QgY3JlYXRlUHJvamVjdCA9IHByb2plY3ROYW1lID0+IHtcclxuICAgIGlmICghcHJvamVjdHNFeGlzdHMoKSkge1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdHNcIiwgSlNPTi5zdHJpbmdpZnkoW25ldyBQcm9qZWN0KHByb2plY3ROYW1lKV0pKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IHVwZGF0ZWRQcm9qZWN0QXJyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInByb2plY3RzXCIpKTtcclxuICAgICAgICB1cGRhdGVkUHJvamVjdEFyci5wdXNoKG5ldyBQcm9qZWN0KHByb2plY3ROYW1lKSk7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJwcm9qZWN0c1wiLCBKU09OLnN0cmluZ2lmeSh1cGRhdGVkUHJvamVjdEFycikpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBSZXR1cm5zIGFuIGFycmF5IG9mIHRoZSBuYW1lcyBvZiBlYWNoIHByb2plY3RcclxuZXhwb3J0IGNvbnN0IGdldFByb2plY3RzID0gKCkgPT4ge1xyXG4gICAgaWYgKHByb2plY3RzRXhpc3RzKCkpIHtcclxuICAgICAgICBjb25zdCBwcm9qZWN0cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c1wiKSk7XHJcbiAgICAgICAgY29uc3QgcHJvamVjdE5hbWVzID0gcHJvamVjdHMubWFwKChwcm9qKSA9PiBwcm9qLnByb2plY3ROYW1lKTtcclxuICAgICAgICByZXR1cm4gcHJvamVjdE5hbWVzO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBSZXR1cm5zIHRydWUvZmFsc2UgZGVwZW5kaW5nIG9uIHdoZXRoZXIgYSBwcm9qZWN0IHdpdGggYSBnaXZlbiBuYW1lIGlzIGV4aXN0c1xyXG5leHBvcnQgY29uc3QgY2hlY2tJZlByb2plY3RFeGlzdHMgPSAocHJvamVjdE5hbWUpID0+IHtcclxuICAgIGlmIChwcm9qZWN0c0V4aXN0cygpKSB7XHJcbiAgICAgICAgcmV0dXJuIGdldFByb2plY3RzKCkuaW5jbHVkZXMocHJvamVjdE5hbWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG4vLyBEZWxldGVzIGEgc3BlY2lmaWVkIHByb2plY3QgZnJvbSBsb2NhbCBzdG9yYWdlXHJcbmV4cG9ydCBjb25zdCBkZWxldGVQcm9qZWN0ID0gKHByb2plY3ROYW1lKSA9PiB7XHJcbiAgICBpZihwcm9qZWN0c0V4aXN0cygpKSB7XHJcbiAgICAgICAgbGV0IHByb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInByb2plY3RzXCIpKVxyXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRQcm9qZWN0cyA9IHByb2plY3RzLmZpbHRlcigocHJvaikgPT4gcHJvai5wcm9qZWN0TmFtZSAhPSBwcm9qZWN0TmFtZSk7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJwcm9qZWN0c1wiLCBKU09OLnN0cmluZ2lmeSh1cGRhdGVkUHJvamVjdHMpKTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gU3RvcmVzIGdpdmVuIHByb2plY3QgbmFtZSBhcyB0aGUgYWN0aXZlIHByb2plY3RcclxuZXhwb3J0IGNvbnN0IHN0b3JlQWN0aXZlUHJvamVjdCA9IChwcm9qZWN0TmFtZSkgPT4ge1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJhY3RpdmVQcm9qZWN0XCIsIHByb2plY3ROYW1lKTtcclxufVxyXG5cclxuLy8gR2V0cyB0aGUgYWN0aXZlIHByb2plY3QgZnJvbSBsb2NhbCBzdG9yYWdlXHJcbmV4cG9ydCBjb25zdCBnZXRBY3RpdmVQcm9qZWN0ID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYWN0aXZlUHJvamVjdFwiKTtcclxufVxyXG5cclxuLy8gR2V0cyBhIHByb2plY3Qgd2l0aCB0aGUgZ2l2ZW4gbmFtZVxyXG5leHBvcnQgY29uc3QgZ2V0UHJvamVjdFdpdGhOYW1lID0gKHByb2plY3ROYW1lKSA9PiB7XHJcbiAgICBjb25zdCBwcm9qZWN0cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c1wiKSk7XHJcbiAgICByZXR1cm4gcHJvamVjdHMuZmluZCgocHJvaikgPT4gcHJvai5wcm9qZWN0TmFtZSA9PSBwcm9qZWN0TmFtZSk7XHJcbn1cclxuXHJcbi8vIEFzc2lnbnMgYSB0b2RvIHRvIGEgcHJvamVjdCAtIGdpdmVuIHRoYXQgcHJvamVjdCBleGlzdHMgLSBhbmQgdXBkYXRlcyBsb2NhbCBzdG9yYWdlXHJcbmV4cG9ydCBjb25zdCBhc3NpZ25Ub2RvVG9Qcm9qZWN0ID0gKHRvZG8sIHByb2plY3ROYW1lKSA9PiB7XHJcbiAgICBjb25zdCB1cGRhdGVkUHJvaiA9IGdldFByb2plY3RXaXRoTmFtZShwcm9qZWN0TmFtZSk7XHJcbiAgICBQcm9qZWN0LmFkZFRvZG8odXBkYXRlZFByb2osIHRvZG8pOyBcclxuICAgIHVwZGF0ZVByb2plY3RMaXN0KHVwZGF0ZWRQcm9qKTtcclxufVxyXG5cclxuLy8gRGVsZXRlcyBzcGVjaWZpYyB0b2RvIGZyb20gc3BlY2lmaWVkIHByb2plY3RcclxuZXhwb3J0IGNvbnN0IGRlbGV0ZVRvZG8gPSAocHJvamVjdE5hbWUsIHRvZG9UaXRsZSkgPT4ge1xyXG4gICAgY29uc3QgcHJvamVjdHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwicHJvamVjdHNcIikpO1xyXG5cclxuICAgIGZvciAoY29uc3QgcHJvaiBvZiBwcm9qZWN0cykge1xyXG4gICAgICAgIGlmIChwcm9qLnByb2plY3ROYW1lID09IHByb2plY3ROYW1lKSB7XHJcbiAgICAgICAgICAgIFByb2plY3QucmVtb3ZlVG9kbyhwcm9qLCB0b2RvVGl0bGUpO1xyXG4gICAgICAgICAgICB1cGRhdGVQcm9qZWN0TGlzdChwcm9qKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuLy8gVXBkYXRlcyBsaXN0cyBvZiBwcm9qZWN0cyBieSBjaGFuZ2luZyBwcm9qZWN0IHdpdGggdXBkYXRlZCBvbmVcclxuY29uc3QgdXBkYXRlUHJvamVjdExpc3QgPSAodXBkYXRlZFByb2plY3QpID0+IHtcclxuICAgIGNvbnN0IHByb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInByb2plY3RzXCIpKTtcclxuXHJcbiAgICBwcm9qZWN0cy5mb3JFYWNoKHByb2ogPT4ge1xyXG4gICAgICAgIGlmIChwcm9qLnByb2plY3ROYW1lID09IHVwZGF0ZWRQcm9qZWN0LnByb2plY3ROYW1lKSB7XHJcbiAgICAgICAgICAgIHByb2plY3RzW3Byb2plY3RzLmluZGV4T2YocHJvaildID0gdXBkYXRlZFByb2plY3Q7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3RzXCIsIEpTT04uc3RyaW5naWZ5KHByb2plY3RzKSk7XHJcbn0iLCJpbXBvcnQgeyBhc3NpZ25Ub2RvVG9Qcm9qZWN0IH0gZnJvbSBcIi4vcHJvamVjdF9sc1wiO1xyXG5cclxuY2xhc3MgVG9kbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUsIHByaW9yaXR5KSB7XHJcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcclxuICAgICAgICB0aGlzLmR1ZURhdGUgPSBkdWVEYXRlO1xyXG4gICAgICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcclxuICAgICAgICB0aGlzLmNvbXBsZXRlZCA9IGZhbHNlOyAvLyBOZWVkZWQ/XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVUb2RvID0gKGZvcm0sIHByb2plY3ROYW1lKSA9PiB7XHJcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShmb3JtKTtcclxuICAgIGNvbnN0IHRvZG8gPSBuZXcgVG9kbyhmb3JtRGF0YS5nZXQoJ3RpdGxlJyksIGZvcm1EYXRhLmdldCgnZGVzYycpLCBmb3JtRGF0YS5nZXQoJ2R1ZS1kYXRlJyksIGZvcm1EYXRhLmdldCgncHJpb3JpdHknKSk7XHJcbiAgICBhc3NpZ25Ub2RvVG9Qcm9qZWN0KHRvZG8sIHByb2plY3ROYW1lKTtcclxufSIsImltcG9ydCB7IGNyZWF0ZVByb2plY3QsIGdldFByb2plY3RzLCBwcm9qZWN0c0V4aXN0cywgY2hlY2tJZlByb2plY3RFeGlzdHMsIGRlbGV0ZVByb2plY3QsIHN0b3JlQWN0aXZlUHJvamVjdCwgZ2V0QWN0aXZlUHJvamVjdCwgZGVsZXRlVG9kbywgZ2V0UHJvamVjdFdpdGhOYW1lIH0gZnJvbSBcIi4vcHJvamVjdF9sc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVUb2RvIH0gZnJvbSBcIi4vdG9kb1wiO1xyXG5pbXBvcnQgeyBnZXRQcm9qZWN0VG9kb3MgfSBmcm9tIFwiLi90b2RvX2xzXCI7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi9wcm9qZWN0XCI7XHJcblxyXG5cclxuLy8gRVZFTlQgTElTVEVORVJTXHJcbi8vIENhbmNlbCBwcm9qZWN0IGJ0blxyXG5jb25zdCBjYW5jZWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbmNlbFwiKTtcclxuY2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0b2dnbGVCdG5Gb3JtVmlzaWJpbGl0eSk7XHJcblxyXG4vLyBDcmVhdGUgcHJvamVjdCBidG5cclxuY29uc3QgY3JlYXRlUHJvamVjdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3JlYXRlLXByb2plY3QtYnRuXCIpO1xyXG5jcmVhdGVQcm9qZWN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB0b2dnbGVCdG5Gb3JtVmlzaWJpbGl0eSgpO1xyXG59KTtcclxuXHJcbi8vIEFkZCBwcm9qZWN0IGJ1dHRvbiBmdW5jdGlvbmFsaXR5XHJcbmNvbnN0IGFkZFByb2plY3RCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZC1wcm9qZWN0LWJ0blwiKTtcclxuYWRkUHJvamVjdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY29uc3QgcHJvamVjdE5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2plY3QtaW5wdXRcIikudmFsdWU7XHJcbiAgICBpZiAocHJvamVjdE5hbWUgPT0gXCJcIikge1xyXG4gICAgICAgIGFsZXJ0KFwiU29ycnksIHBsZWFzZSBlbnRlciBhIHZhbGlkIHByb2plY3QgbmFtZVwiKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9IGVsc2UgaWYgKGNoZWNrSWZQcm9qZWN0RXhpc3RzKHByb2plY3ROYW1lKSkge1xyXG4gICAgICAgIGFsZXJ0KFwiU29ycnksIGEgcHJvamVjdCB3aXRoIHRoYXQgbmFtZSBhbHJlYWR5IGV4aXN0cyFcIik7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdG9nZ2xlQnRuRm9ybVZpc2liaWxpdHkoKTtcclxuICAgIGNyZWF0ZVByb2plY3QocHJvamVjdE5hbWUpO1xyXG4gICAgYWRkUHJvamVjdFRvVGFiKHByb2plY3ROYW1lKTtcclxufSk7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy8gRGlzcGxheXMgdGhlIHRvZG9zIGZvciB0aGUgc3BlY2lmaWVkIHByb2plY3RcclxuY29uc3QgZGlzcGxheVRvZG9zID0gKHByb2plY3ROYW1lKSA9PiB7XHJcbiAgICBjb25zdCB0b2RvcyA9IGdldFByb2plY3RUb2Rvcyhwcm9qZWN0TmFtZSk7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvZG9zXCIpO1xyXG4gICAgY29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XHJcblxyXG4gICAgdG9kb3MuZm9yRWFjaCh0b2RvID0+IHtcclxuICAgICAgICBjb25zdCB0b2RvRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgY29uc3QgZGVsZXRlVG9kb0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcblxyXG4gICAgICAgIHRvZG9FbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWl0ZW1cIik7XHJcbiAgICAgICAgZGVsZXRlVG9kb0J0bi5pbm5lclRleHQgPSBcIkRlbGV0ZSBUb2RvXCI7XHJcbiAgICAgICAgZGVsZXRlVG9kb0J0bi5jbGFzc0xpc3QuYWRkKFwiZGVsZXRlLXRvZG8tYnRuXCIpO1xyXG4gICAgICAgIGRlbGV0ZVRvZG9CdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgZGVsZXRlVG9kbyhwcm9qZWN0TmFtZSwgdG9kby50aXRsZSk7XHJcbiAgICAgICAgICAgIGRpc3BsYXlUb2Rvcyhwcm9qZWN0TmFtZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRvZG9FbGVtZW50LmlubmVySFRNTCA9IGBcclxuICAgICAgICAgICAgPGgzIGNsYXNzPVwidG9kby10aXRsZSBwcmlvcml0eS0ke3RvZG8ucHJpb3JpdHl9XCI+JHt0b2RvLnRpdGxlfTwvaDM+XHJcbiAgICAgICAgICAgIDxwIGNsYXNzPVwidG9kby1kZXNjXCI+JHt0b2RvLmRlc2NyaXB0aW9ufTwvcD5cclxuICAgICAgICAgICAgPHAgY2xhc3M9XCJ0b2RvLWRhdGVcIj5EdWU6ICR7dG9kby5kdWVEYXRlfTwvcD5cclxuICAgICAgICBgO1xyXG4gICAgICAgIHRvZG9FbGVtZW50LmFwcGVuZENoaWxkKGRlbGV0ZVRvZG9CdG4pO1xyXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0b2RvRWxlbWVudCk7XHJcbiAgICB9KVxyXG59XHJcblxyXG4vLyBVc2VkIG9uIGZpcnN0IHJlbG9hZCB0byBhZGQgdGhlIHByb2plY3RzIHRvIHRoZSBzaWRlYmFyXHJcbmV4cG9ydCBjb25zdCBkaXNwbGF5U3RvcmVkUHJvamVjdHMgPSAoKSA9PiB7XHJcbiAgICBpZiAocHJvamVjdHNFeGlzdHMoKSkge1xyXG4gICAgICAgIGNvbnN0IHByb2plY3RzID0gZ2V0UHJvamVjdHMoKTtcclxuICAgIFxyXG4gICAgICAgIGNsZWFyUHJvamVjdHNUYWIoKTtcclxuXHJcbiAgICAgICAgcHJvamVjdHMuZm9yRWFjaChwcm9qZWN0ID0+IHtcclxuICAgICAgICAgICAgYWRkUHJvamVjdFRvVGFiKHByb2plY3QpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBHZXRzIHJpZCBvZiBhbGwgdGhlIHByb2plY3QgSFRNTCAoTk9UIEZST00gTE9DQUwgU1RPUkFHRSlcclxuY29uc3QgY2xlYXJQcm9qZWN0c1RhYiA9ICgpID0+IHtcclxuICAgIGNvbnN0IGxpc3RPZlByb2plY3RzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9qZWN0c1wiKTtcclxuICAgIHdoaWxlIChsaXN0T2ZQcm9qZWN0cy5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgbGlzdE9mUHJvamVjdHMucmVtb3ZlQ2hpbGQobGlzdE9mUHJvamVjdHMuZmlyc3RDaGlsZCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIFRvZ2dsZXMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIGNyZWF0ZSBwcm9qZWN0IGJ1dHRvbiBhbmQgcHJvamVjdCBmb3JtXHJcbmZ1bmN0aW9uIHRvZ2dsZUJ0bkZvcm1WaXNpYmlsaXR5KCkge1xyXG4gICAgdG9nZ2xlQ3JlYXRlUHJvamVjdCgpO1xyXG4gICAgZGlzcGxheVByb2plY3RGb3JtKCk7XHJcbn1cclxuXHJcbi8vIENyZWF0ZSBwcm9qZWN0IGJ1dHRvbiBldmVudHNcclxuXHJcbi8vIERpc3BsYXkgdGhlIGZvcm0gZm9yIGNyZWF0aW5nIGEgcHJvamVjdCBcclxuZXhwb3J0IGNvbnN0IHRvZ2dsZUNyZWF0ZVByb2plY3QgPSAoKSA9PiB7XHJcbiAgICBjcmVhdGVQcm9qZWN0QnRuLmNsYXNzTGlzdC50b2dnbGUoXCJoaWRkZW5cIik7XHJcbn1cclxuXHJcbi8vIERpc3BsYXkgYWRkIHByb2plY3QgZm9ybVxyXG5leHBvcnQgY29uc3QgZGlzcGxheVByb2plY3RGb3JtID0gKCkgPT4geyAvLyBUT0RPIHJlbmFtZSB0byB0b2dnbGVcclxuICAgIGNvbnN0IGFkZFByb2plY3RGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGQtcHJvamVjdC1mb3JtXCIpO1xyXG4gICAgYWRkUHJvamVjdEZvcm0uY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKTtcclxuICAgIC8vIE1ha2Ugc3VyZSBpbnB1dCBpcyBlbXB0eSBvbmNlIGhpZGRlblxyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9qZWN0LWlucHV0XCIpLnZhbHVlID0gXCJcIjtcclxufTtcclxuXHJcbi8vIFByb2plY3QgdGFiIGZ1bmN0aW9uYWxpdHlcclxuXHJcbi8vIEFkZHMgcHJvamVjdCB0byBwcm9qZWN0IHRhYlxyXG5jb25zdCBhZGRQcm9qZWN0VG9UYWIgPSBwcm9qZWN0TmFtZSA9PiB7XHJcbiAgICBjb25zdCBsaXN0T2ZQcm9qZWN0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvamVjdHNcIik7XHJcbiAgICBcclxuICAgIGNvbnN0IHByb2plY3RFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xyXG4gICAgY29uc3QgcHJvamVjdE5hbWVCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgY29uc3QgcHJvamVjdENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICBjb25zdCBwcm9qZWN0VGV4dCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHByb2plY3ROYW1lKTtcclxuXHJcbiAgICBpZiAocHJvamVjdE5hbWUgPT0gZ2V0QWN0aXZlUHJvamVjdCgpKSB7XHJcbiAgICAgICAgc2V0QWN0aXZlUHJvamVjdChwcm9qZWN0TmFtZSwgcHJvamVjdE5hbWVCdXR0b24pO1xyXG4gICAgfVxyXG4gICAgcHJvamVjdE5hbWVCdXR0b24uY2xhc3NMaXN0LmFkZChcInByb2plY3QtbmFtZS1idG5cIik7XHJcbiAgICBwcm9qZWN0TmFtZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gc2V0QWN0aXZlUHJvamVjdChwcm9qZWN0TmFtZSwgcHJvamVjdE5hbWVCdXR0b24pKTtcclxuICAgIHByb2plY3RFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LW5hbWVcIik7XHJcbiAgICBwcm9qZWN0RWxlbWVudC5hcHBlbmRDaGlsZChwcm9qZWN0TmFtZUJ1dHRvbik7XHJcbiAgICBwcm9qZWN0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtY29udGFpbmVyJyk7XHJcbiAgICBwcm9qZWN0Q29udGFpbmVyLmFwcGVuZENoaWxkKHByb2plY3RFbGVtZW50KTtcclxuICAgIHByb2plY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlRGVsZXRlUHJvamVjdEZvcm0ocHJvamVjdE5hbWUpKTtcclxuXHJcbiAgICBwcm9qZWN0TmFtZUJ1dHRvbi5hcHBlbmRDaGlsZChwcm9qZWN0VGV4dCk7XHJcbiAgICBsaXN0T2ZQcm9qZWN0cy5hcHBlbmRDaGlsZChwcm9qZWN0Q29udGFpbmVyKTtcclxufVxyXG5cclxuLy8gRGVsZXRlIHByb2plY3QgZm9ybSAoZm4gcmV0dXJucyBhIGh0bWwgZm9ybSlcclxuY29uc3QgY3JlYXRlRGVsZXRlUHJvamVjdEZvcm0gPSAocHJvamVjdE5hbWUpID0+IHtcclxuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKTtcclxuICAgIGNvbnN0IGRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7ICAgIFxyXG4gICAgZm9ybS5hcHBlbmRDaGlsZChkZWxldGVCdG4pO1xyXG5cclxuICAgIGRlbGV0ZUJ0bi5pbm5lclRleHQgPSBcIkRlbGV0ZVwiO1xyXG4gICAgZGVsZXRlQnRuLnZhbHVlID0gcHJvamVjdE5hbWU7XHJcbiAgICBkZWxldGVCdG4uY2xhc3NMaXN0LmFkZChcImRlbGV0ZS1wcm9qZWN0LWJ0blwiKTtcclxuICAgIGRlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZXZlbnQgPT4ge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgZGVsZXRlUHJvamVjdChwcm9qZWN0TmFtZSk7XHJcbiAgICAgICAgY2xlYXJBY3RpdmVQcm9qZWN0cygpO1xyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9kby1jb250YWluZXJcIikuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICBkaXNwbGF5U3RvcmVkUHJvamVjdHMoKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZvcm07XHJcbn1cclxuXHJcbi8vIHNob3VsZCBzZXQgdmFsdWUgb2Ygc3VibWl0IHRvIGN1cnJlbnQgYWN0aXZlIHByb2plY3RcclxuY29uc3Qgc2V0QWN0aXZlUHJvamVjdCA9IChwcm9qZWN0TmFtZSwgcHJvamVjdE5hbWVCdXR0b24pID0+IHtcclxuICAgIGNsZWFyQWN0aXZlUHJvamVjdHMoKTtcclxuICAgIHByb2plY3ROYW1lQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJhY3RpdmUtcHJvamVjdFwiKTtcclxuICAgIGFkZFRvZG9Gb3Jtc0NvbnRhaW5lcihwcm9qZWN0TmFtZSk7XHJcbiAgICBzdG9yZUFjdGl2ZVByb2plY3QocHJvamVjdE5hbWUpO1xyXG4gICAgZGlzcGxheVRvZG9zKHByb2plY3ROYW1lKTtcclxufVxyXG5cclxuLy8gR2V0cyByaWQgb2YgdGhlIGFjdGl2ZSBwcm9qZWN0IGNsYXNzIGZyb20gcHJvamVjdCBidXR0b25zXHJcbmNvbnN0IGNsZWFyQWN0aXZlUHJvamVjdHMgPSAoKSA9PiB7XHJcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJwcm9qZWN0LW5hbWUtYnRuXCIpLCBwcm9qZWN0QnRuID0+IHtcclxuICAgICAgICBwcm9qZWN0QnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmUtcHJvamVjdFwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBBZGRzIHRoZSBjcmVhdGUgdG9kbyBmb3JtcyB0byB0aGUgdG9kbyBjb250YWluZXJcclxuY29uc3QgYWRkVG9kb0Zvcm1zQ29udGFpbmVyID0gKHByb2plY3ROYW1lKSA9PiB7XHJcbiAgICBjb25zdCB0b2RvQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b2RvLWNvbnRhaW5lclwiKTtcclxuXHJcbiAgICB0b2RvQ29udGFpbmVyLmlubmVySFRNTCA9IGBcclxuICAgICAgICA8ZGl2IGlkPVwidG9kb3NcIj48L2Rpdj5cclxuICAgICAgICA8YnV0dG9uIGlkPVwiY3JlYXRlLXRvZG8tYnRuXCI+Q3JlYXRlIFRvZG88L2J1dHRvbj5cclxuICAgICAgICA8Zm9ybSBpZD1cImNyZWF0ZS10b2RvLWZvcm1cIiBjbGFzcz1cImhpZGRlblwiPlxyXG4gICAgICAgICAgICA8bGFiZWwgZm9yPVwidG9kby1mb3JtLXRpdGxlXCI+VG9kbyBOYW1lPC9sYWJlbD5cclxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmFtZT1cInRpdGxlXCIgaWQ9XCJ0b2RvLWZvcm0tdGl0bGVcIiBwbGFjZWhvbGRlcj1cIk5hbWUgb2YgdG9kb1wiIHJlcXVpcmVkPlxyXG4gICAgICAgICAgICA8bGFiZWwgZm9yPVwidG9kby1mb3JtLWRlc2NcIj5EZXNjcmlwdGlvbjwvbGFiZWw+XHJcbiAgICAgICAgICAgIDx0ZXh0YXJlYSBuYW1lPVwiZGVzY1wiIGlkPVwidG9kby1mb3JtLWRlc2NcIiBjb2xzPVwiMzBcIiByb3dzPVwiMTBcIiBwbGFjZWhvbGRlcj1cIk9wdGlvbmFsIGRlc2NyaXB0aW9uLi4uXCI+PC90ZXh0YXJlYT5cclxuICAgICAgICAgICAgPGxhYmVsIGZvcj1cInRvZG8tcHJpb3JpdHlcIj5Qcmlvcml0eTwvbGFiZWw+XHJcbiAgICAgICAgICAgIDxzZWxlY3QgbmFtZT1cInByaW9yaXR5XCIgaWQ9XCJ0b2RvLXByaW9yaXR5XCIgcmVxdWlyZWQ+XHJcbiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwibG93XCI+TG93PC9vcHRpb24+XHJcbiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwibWVkaXVtXCI+TWVkaXVtPC9vcHRpb24+XHJcbiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiaGlnaFwiPkhpZ2g8L29wdGlvbj5cclxuICAgICAgICAgICAgPC9zZWxlY3Q+XHJcbiAgICAgICAgICAgIDxsYWJlbCBmb3I9XCJ0b2RvLWRhdGUtaW5wdXRcIj5EdWUgRGF0ZTwvbGFiZWw+XHJcbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiZGF0ZVwiIG5hbWU9XCJkdWUtZGF0ZVwiIGlkPVwidG9kby1kYXRlLWlucHV0XCIgcmVxdWlyZWQ+XHJcbiAgICAgICAgICAgIDxidXR0b24gdHlwZT1cInN1Ym1pdFwiIGlkPVwiYWRkLXRvZG8tYnRuXCIgdmFsdWU9XCIke3Byb2plY3ROYW1lfVwiPkNyZWF0ZSBUb2RvPC9idXR0b24+XHJcbiAgICAgICAgICAgIDxidXR0b24gaWQ9XCJhZGQtdG9kby1jYW5jZWwtYnRuXCIgY2xhc3M9XCJkZWxldGUtdG9kby1idG5cIj5DYW5jZWw8L2J1dHRvbj5cclxuICAgICAgICA8L2Zvcm0+XHJcbiAgICBgO1xyXG4gICAgXHJcbiAgICBjb25zdCBjcmVhdGVUb2RvRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3JlYXRlLXRvZG8tZm9ybVwiKTtcclxuICAgIGNyZWF0ZVRvZG9Gb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZXZlbnQgPT4ge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgaWYgKFByb2plY3QudG9kb0V4aXN0cyhnZXRQcm9qZWN0V2l0aE5hbWUocHJvamVjdE5hbWUpLCBuZXcgRm9ybURhdGEoY3JlYXRlVG9kb0Zvcm0pLmdldChcInRpdGxlXCIpKSkge1xyXG4gICAgICAgICAgICBhbGVydChcIlNvcnJ5LCBhIHRvZG8gd2l0aCB0aGlzIG5hbWUgYWxyZWFkeSBleGlzdHMhXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNyZWF0ZVRvZG8oY3JlYXRlVG9kb0Zvcm0sIHByb2plY3ROYW1lKTtcclxuICAgICAgICBkaXNwbGF5VG9kb3MocHJvamVjdE5hbWUpO1xyXG4gICAgICAgIGNyZWF0ZVRvZG9Gb3JtLnJlc2V0KCk7XHJcbiAgICAgICAgdG9nZ2xlQ3JlYXRlVG9kb0Zvcm0oKTtcclxuICAgIH0pXHJcblxyXG4gICAgLy8gVE9ETyAtIFBVVCBJTiBTRVBBUkFURSBGVU5DVElPTlxyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjcmVhdGUtdG9kby1idG5cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGV2ZW50ID0+IHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRvZ2dsZUNyZWF0ZVRvZG9Gb3JtKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZC10b2RvLWNhbmNlbC1idG5cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGV2ZW50ID0+IHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRvZ2dsZUNyZWF0ZVRvZG9Gb3JtKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuY29uc3QgdG9nZ2xlQ3JlYXRlVG9kb0Zvcm0gPSAoKSA9PiB7XHJcbiAgICBjb25zdCBjcmVhdGVUb2RvQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjcmVhdGUtdG9kby1idG5cIik7XHJcbiAgICBjb25zdCBjcmVhdGVUb2RvRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3JlYXRlLXRvZG8tZm9ybVwiKTtcclxuICAgIGNyZWF0ZVRvZG9CdG4uY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKTtcclxuICAgIGNyZWF0ZVRvZG9Gb3JtLmNsYXNzTGlzdC50b2dnbGUoXCJoaWRkZW5cIik7XHJcbn0iLCIvLyBHZXRzIHRvZG9zIGZyb20gbG9jYWwgc3RvcmFnZSBmb3IgYSBnaXZlbiBwcm9qZWN0XHJcbmV4cG9ydCBjb25zdCBnZXRQcm9qZWN0VG9kb3MgPSAocHJvamVjdE5hbWUpID0+IHtcclxuICAgIGNvbnN0IHByb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInByb2plY3RzXCIpKTtcclxuICAgIGxldCB0b2RvcztcclxuICAgIHByb2plY3RzLmZvckVhY2gocHJvamVjdCA9PiB7XHJcbiAgICAgICAgaWYgKHByb2plY3QucHJvamVjdE5hbWUgPT0gcHJvamVjdE5hbWUpIHtcclxuICAgICAgICAgICAgdG9kb3MgPSBwcm9qZWN0LnRvZG9zO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRvZG9zO1xyXG59IiwiaW1wb3J0IHsgZGlzcGxheVN0b3JlZFByb2plY3RzIH0gZnJvbSBcIi4vVUlcIjtcclxuZGlzcGxheVN0b3JlZFByb2plY3RzKCk7Il0sIm5hbWVzIjpbIlByb2plY3QiLCJjb25zdHJ1Y3RvciIsInByb2plY3ROYW1lIiwidGhpcyIsInRvZG9zIiwic3RhdGljIiwicHJvaiIsInRvZG8iLCJwdXNoIiwidG9kb05hbWUiLCJmaWx0ZXIiLCJ0aXRsZSIsInByb2plY3RzRXhpc3RzIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImxlbmd0aCIsImdldFByb2plY3RzIiwiSlNPTiIsInBhcnNlIiwibWFwIiwiZ2V0UHJvamVjdFdpdGhOYW1lIiwiZmluZCIsInVwZGF0ZVByb2plY3RMaXN0IiwidXBkYXRlZFByb2plY3QiLCJwcm9qZWN0cyIsImZvckVhY2giLCJpbmRleE9mIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsIlRvZG8iLCJkZXNjcmlwdGlvbiIsImR1ZURhdGUiLCJwcmlvcml0eSIsImNvbXBsZXRlZCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJhZGRFdmVudExpc3RlbmVyIiwidG9nZ2xlQnRuRm9ybVZpc2liaWxpdHkiLCJjcmVhdGVQcm9qZWN0QnRuIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInZhbHVlIiwiYWxlcnQiLCJpbmNsdWRlcyIsImNoZWNrSWZQcm9qZWN0RXhpc3RzIiwidXBkYXRlZFByb2plY3RBcnIiLCJjcmVhdGVQcm9qZWN0IiwiYWRkUHJvamVjdFRvVGFiIiwiZGlzcGxheVRvZG9zIiwicHJvamVjdCIsImdldFByb2plY3RUb2RvcyIsImNvbnRhaW5lciIsImlubmVySFRNTCIsInRvZG9FbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsImRlbGV0ZVRvZG9CdG4iLCJjbGFzc0xpc3QiLCJhZGQiLCJpbm5lclRleHQiLCJ0b2RvVGl0bGUiLCJyZW1vdmVUb2RvIiwiZGVsZXRlVG9kbyIsImFwcGVuZENoaWxkIiwiZGlzcGxheVN0b3JlZFByb2plY3RzIiwiY2xlYXJQcm9qZWN0c1RhYiIsImxpc3RPZlByb2plY3RzIiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwidG9nZ2xlQ3JlYXRlUHJvamVjdCIsImRpc3BsYXlQcm9qZWN0Rm9ybSIsInRvZ2dsZSIsInByb2plY3RFbGVtZW50IiwicHJvamVjdE5hbWVCdXR0b24iLCJwcm9qZWN0Q29udGFpbmVyIiwicHJvamVjdFRleHQiLCJjcmVhdGVUZXh0Tm9kZSIsInNldEFjdGl2ZVByb2plY3QiLCJjcmVhdGVEZWxldGVQcm9qZWN0Rm9ybSIsImZvcm0iLCJkZWxldGVCdG4iLCJ1cGRhdGVkUHJvamVjdHMiLCJkZWxldGVQcm9qZWN0IiwiY2xlYXJBY3RpdmVQcm9qZWN0cyIsImFkZFRvZG9Gb3Jtc0NvbnRhaW5lciIsInN0b3JlQWN0aXZlUHJvamVjdCIsIkFycmF5IiwicHJvdG90eXBlIiwiY2FsbCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJwcm9qZWN0QnRuIiwicmVtb3ZlIiwiY3JlYXRlVG9kb0Zvcm0iLCJ0b2RvRXhpc3RzIiwiRm9ybURhdGEiLCJnZXQiLCJmb3JtRGF0YSIsInVwZGF0ZWRQcm9qIiwiYWRkVG9kbyIsImFzc2lnblRvZG9Ub1Byb2plY3QiLCJjcmVhdGVUb2RvIiwicmVzZXQiLCJ0b2dnbGVDcmVhdGVUb2RvRm9ybSIsImNyZWF0ZVRvZG9CdG4iXSwic291cmNlUm9vdCI6IiJ9