(()=>{"use strict";class e{constructor(e){this.projectName=e,this.todos=[]}static addTodo=(e,t)=>{e.todos.push(t)};static removeTodo=(e,t)=>{e.todos=e.todos.filter((e=>e.title!=t))};static todoExists=(e,t)=>{for(const o of e.todos)if(o.title==t)return!0;return!1}}const t=()=>null!==localStorage.getItem("projects")&&localStorage.getItem("projects").length>0,o=()=>{if(t())return JSON.parse(localStorage.getItem("projects")).map((e=>e.projectName))},n=e=>JSON.parse(localStorage.getItem("projects")).find((t=>t.projectName==e)),r=e=>{const t=JSON.parse(localStorage.getItem("projects"));t.forEach((o=>{o.projectName==e.projectName&&(t[t.indexOf(o)]=e)})),localStorage.setItem("projects",JSON.stringify(t))};class d{constructor(e,t,o,n){this.title=e,this.description=t,this.dueDate=o,this.priority=n,this.completed=!1}getTitle(){return this.title}getDescription(){return this.description}getDueDate(){return this.dueDate}getPriority(){return this.priority}isCompleted(){return this.completed}}const a=t=>{const o=(e=>{let t;return JSON.parse(localStorage.getItem("projects")).forEach((o=>{o.projectName==e&&(t=o.todos)})),t})(t),n=document.getElementById("todos");n.innerHTML="",o.forEach((o=>{const d=document.createElement("div"),c=document.createElement("button");d.classList.add("todo-item"),c.innerText="Delete Project",c.classList.add("delete-todo-btn"),c.addEventListener("click",(()=>{((t,o)=>{const n=JSON.parse(localStorage.getItem("projects"));for(const d of n)if(d.projectName==t)return e.removeTodo(d,o),void r(d)})(t,o.title),a(t)})),d.innerHTML=`\n            <h3 class="todo-title priority-${o.priority}">${o.title}</h3>\n            <p class="todo-desc">${o.description}</p>\n            <p class="todo-date">Due: ${o.dueDate}</p>\n        `,d.appendChild(c),n.appendChild(d)}))},c=()=>{if(t()){const e=o();i(),e.forEach((e=>{u(e)}))}},i=()=>{const e=document.getElementById("projects");for(;e.firstChild;)e.removeChild(e.firstChild)};function l(){m(),p()}const s=document.getElementById("create-project-btn");s.addEventListener("click",(e=>{e.preventDefault(),l()}));const m=()=>{s.classList.toggle("hidden")},p=()=>{document.getElementById("add-project-form").classList.toggle("hidden"),document.getElementById("project-input").value=""};document.getElementById("cancel").addEventListener("click",l),document.getElementById("add-project-btn").addEventListener("click",(()=>{const n=document.getElementById("project-input").value;return""==n?(alert("Sorry, please enter a valid project name"),!1):(e=>!!t()&&o().includes(e))(n)?(alert("Sorry, a project with that name already exists!"),!1):(l(),(o=>{if(t()){let t=JSON.parse(localStorage.getItem("projects"));t.push(new e(o)),localStorage.setItem("projects",JSON.stringify(t))}else localStorage.setItem("projects",JSON.stringify([new e(o)]))})(n),void u(n))}));const u=e=>{const t=document.getElementById("projects"),o=document.createElement("li"),n=document.createElement("button"),r=document.createElement("div"),d=document.createTextNode(e);e==localStorage.getItem("activeProject")&&f(e,n),n.classList.add("project-name-btn"),n.addEventListener("click",(()=>f(e,n))),o.classList.add("project-name"),o.appendChild(n),r.classList.add("project-container"),r.appendChild(o),r.appendChild(g(e)),n.appendChild(d),t.appendChild(r)},g=e=>{const o=document.createElement("form"),n=document.createElement("button");return o.appendChild(n),n.innerText="Delete",n.value=e,n.classList.add("delete-project-btn"),n.addEventListener("click",(o=>{o.preventDefault(),(e=>{if(t()){const t=JSON.parse(localStorage.getItem("projects")).filter((t=>t.projectName!=e));localStorage.setItem("projects",JSON.stringify(t))}})(e),h(),document.getElementById("todo-container").innerHTML="",c()})),o},f=(e,t)=>{h(),t.classList.toggle("active-project"),y(e),(e=>{localStorage.setItem("activeProject",e)})(e),a(e)},h=()=>{Array.prototype.forEach.call(document.getElementsByClassName("project-name-btn"),(e=>{e.classList.remove("active-project")}))},y=t=>{document.getElementById("todo-container").innerHTML=`\n        <div id="todos"></div>\n        <button id="create-todo-btn">Create Todo</button>\n        <form id="create-todo-form" class="hidden">\n            <label for="todo-form-title">Todo Name</label>\n            <input type="text" name="title" id="todo-form-title" placeholder="Name of todo" required>\n            <label for="todo-form-desc">Description</label>\n            <textarea name="desc" id="todo-form-desc" cols="30" rows="10" placeholder="Optional description..."></textarea>\n            <label for="todo-priority">Priority</label>\n            <select name="priority" id="todo-priority" required>\n                <option value="low">Low</option>\n                <option value="medium">Medium</option>\n                <option value="high">High</option>\n            </select>\n            <label for="todo-date-input">Due Date</label>\n            <input type="date" name="due-date" id="todo-date-input" required>\n            <button type="submit" id="add-todo-btn" value="${t}">Create Todo</button>\n            <button id="add-todo-cancel-btn" class="delete-todo-btn">Cancel</button>\n        </form>\n    `;const o=document.getElementById("create-todo-form");o.addEventListener("submit",(c=>{if(c.preventDefault(),e.todoExists(n(t),new FormData(o).get("title")))return alert("Sorry, a todo with this name already exists!"),!1;((t,o)=>{const a=new FormData(t);((t,o)=>{const d=n(o);e.addTodo(d,t),r(d)})(new d(a.get("title"),a.get("desc"),a.get("due-date"),a.get("priority")),o)})(o,t),a(t),o.reset(),j()})),document.getElementById("create-todo-btn").addEventListener("click",(e=>{e.preventDefault(),j()})),document.getElementById("add-todo-cancel-btn").addEventListener("click",(e=>{e.preventDefault(),j()}))},j=()=>{const e=document.getElementById("create-todo-btn"),t=document.getElementById("create-todo-form");e.classList.toggle("hidden"),t.classList.toggle("hidden")};c()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQU8sTUFBTUEsRUFDVCxXQUFBQyxDQUFZQyxHQUNSQyxLQUFLRCxZQUFjQSxFQUNuQkMsS0FBS0MsTUFBUSxFQUNqQixDQUdBQyxlQUFpQixDQUFDQyxFQUFNQyxLQUNwQkQsRUFBS0YsTUFBTUksS0FBS0QsRUFBSyxFQUd6QkYsa0JBQW9CLENBQUNDLEVBQU1HLEtBQ3ZCSCxFQUFLRixNQUFRRSxFQUFLRixNQUFNTSxRQUFRSCxHQUFTQSxFQUFLSSxPQUFTRixHQUFTLEVBSXBFSixrQkFBb0IsQ0FBQ0MsRUFBTUcsS0FDdkIsSUFBSSxNQUFNRixLQUFRRCxFQUFLRixNQUNuQixHQUFJRyxFQUFLSSxPQUFTRixFQUNkLE9BQU8sRUFHZixPQUFPLENBQUssRUNwQmIsTUFBTUcsRUFBaUIsSUFDa0IsT0FBckNDLGFBQWFDLFFBQVEsYUFBd0JELGFBQWFDLFFBQVEsWUFBWUMsT0FBUyxFQWVyRkMsRUFBYyxLQUN2QixHQUFJSixJQUdBLE9BRmlCSyxLQUFLQyxNQUFNTCxhQUFhQyxRQUFRLGFBQ25CSyxLQUFLYixHQUFTQSxFQUFLSixhQUVyRCxFQStCU2tCLEVBQXNCbEIsR0FDZGUsS0FBS0MsTUFBTUwsYUFBYUMsUUFBUSxhQUNqQ08sTUFBTWYsR0FBU0EsRUFBS0osYUFBZUEsSUF3QmpEb0IsRUFBcUJDLElBQ3ZCLE1BQU1DLEVBQVdQLEtBQUtDLE1BQU1MLGFBQWFDLFFBQVEsYUFFakRVLEVBQVNDLFNBQVFuQixJQUNUQSxFQUFLSixhQUFlcUIsRUFBZXJCLGNBQ25Dc0IsRUFBU0EsRUFBU0UsUUFBUXBCLElBQVNpQixFQUN2QyxJQUVKVixhQUFhYyxRQUFRLFdBQVlWLEtBQUtXLFVBQVVKLEdBQVUsRUN0RjlELE1BQU1LLEVBQ0YsV0FBQTVCLENBQVlVLEVBQU9tQixFQUFhQyxFQUFTQyxHQUNyQzdCLEtBQUtRLE1BQVFBLEVBQ2JSLEtBQUsyQixZQUFjQSxFQUNuQjNCLEtBQUs0QixRQUFVQSxFQUNmNUIsS0FBSzZCLFNBQVdBLEVBQ2hCN0IsS0FBSzhCLFdBQVksQ0FDckIsQ0FJQSxRQUFBQyxHQUNJLE9BQU8vQixLQUFLUSxLQUNoQixDQUVBLGNBQUF3QixHQUNJLE9BQU9oQyxLQUFLMkIsV0FDaEIsQ0FFQSxVQUFBTSxHQUNJLE9BQU9qQyxLQUFLNEIsT0FDaEIsQ0FFQSxXQUFBTSxHQUNJLE9BQU9sQyxLQUFLNkIsUUFDaEIsQ0FFQSxXQUFBTSxHQUNJLE9BQU9uQyxLQUFLOEIsU0FDaEIsRUFLRyxNQ3ZCRE0sRUFBZ0JyQyxJQUNsQixNQUFNRSxFQ2JxQixDQUFDRixJQUU1QixJQUFJRSxFQU1KLE9BUGlCYSxLQUFLQyxNQUFNTCxhQUFhQyxRQUFRLGFBRXhDVyxTQUFRZSxJQUNUQSxFQUFRdEMsYUFBZUEsSUFDdkJFLEVBQVFvQyxFQUFRcEMsTUFDcEIsSUFFR0EsQ0FBSyxFREtFcUMsQ0FBZ0J2QyxHQUN4QndDLEVBQVlDLFNBQVNDLGVBQWUsU0FDMUNGLEVBQVVHLFVBQVksR0FFdEJ6QyxFQUFNcUIsU0FBUWxCLElBQ1YsTUFBTXVDLEVBQWNILFNBQVNJLGNBQWMsT0FDckNDLEVBQWdCTCxTQUFTSSxjQUFjLFVBRTdDRCxFQUFZRyxVQUFVQyxJQUFJLGFBQzFCRixFQUFjRyxVQUFZLGlCQUMxQkgsRUFBY0MsVUFBVUMsSUFBSSxtQkFDNUJGLEVBQWNJLGlCQUFpQixTQUFTLEtGMEN0QixFQUFDbEQsRUFBYW1ELEtBQ3BDLE1BQU03QixFQUFXUCxLQUFLQyxNQUFNTCxhQUFhQyxRQUFRLGFBRWpELElBQUssTUFBTVIsS0FBUWtCLEVBQ2YsR0FBSWxCLEVBQUtKLGFBQWVBLEVBR3BCLE9BRkFGLEVBQVFzRCxXQUFXaEQsRUFBTStDLFFBQ3pCL0IsRUFBa0JoQixFQUcxQixFRWxEUWlELENBQVdyRCxFQUFhSyxFQUFLSSxPQUM3QjRCLEVBQWFyQyxFQUFZLElBRzdCNEMsRUFBWUQsVUFBWSxnREFDYXRDLEVBQUt5QixhQUFhekIsRUFBS0ksZ0RBQ2pDSixFQUFLdUIsMERBQ0F2QixFQUFLd0Isd0JBRXJDZSxFQUFZVSxZQUFZUixHQUN4Qk4sRUFBVWMsWUFBWVYsRUFBWSxHQUNyQyxFQUlRVyxFQUF3QixLQUNqQyxHQUFJN0MsSUFBa0IsQ0FDbEIsTUFBTVksRUFBV1IsSUFFakIwQyxJQUVBbEMsRUFBU0MsU0FBUWUsSUFDYm1CLEVBQWdCbkIsRUFBUSxHQUVoQyxHQUlFa0IsRUFBbUIsS0FDckIsTUFBTUUsRUFBaUJqQixTQUFTQyxlQUFlLFlBQy9DLEtBQU9nQixFQUFlQyxZQUNsQkQsRUFBZUUsWUFBWUYsRUFBZUMsV0FDOUMsRUFJSixTQUFTRSxJQUNMQyxJQUNBQyxHQUNKLENBSUEsTUFBTUMsRUFBbUJ2QixTQUFTQyxlQUFlLHNCQUNqRHNCLEVBQWlCZCxpQkFBaUIsU0FBVWUsSUFDeENBLEVBQU1DLGlCQUNOTCxHQUF5QixJQUl0QixNQUFNQyxFQUFzQixLQUMvQkUsRUFBaUJqQixVQUFVb0IsT0FBTyxTQUFTLEVBSWxDSixFQUFxQixLQUNQdEIsU0FBU0MsZUFBZSxvQkFDaENLLFVBQVVvQixPQUFPLFVBRWhDMUIsU0FBU0MsZUFBZSxpQkFBaUIwQixNQUFRLEVBQUUsRUFJckMzQixTQUFTQyxlQUFlLFVBQ2hDUSxpQkFBaUIsUUFBU1csR0FHZHBCLFNBQVNDLGVBQWUsbUJBQ2hDUSxpQkFBaUIsU0FBUyxLQUNwQyxNQUFNbEQsRUFBY3lDLFNBQVNDLGVBQWUsaUJBQWlCMEIsTUFDN0QsTUFBbUIsSUFBZnBFLEdBQ0FxRSxNQUFNLDZDQUNDLEdGdkVxQixDQUFDckUsS0FDN0JVLEtBQ09JLElBQWN3RCxTQUFTdEUsR0VzRXZCdUUsQ0FBcUJ2RSxJQUM1QnFFLE1BQU0sb0RBQ0MsSUFFWFIsSUZoR3lCN0QsS0FDekIsR0FBS1UsSUFFRSxDQUNILElBQUk4RCxFQUFvQnpELEtBQUtDLE1BQU1MLGFBQWFDLFFBQVEsYUFDeEQ0RCxFQUFrQmxFLEtBQUssSUFBSVIsRUFBUUUsSUFDbkNXLGFBQWFjLFFBQVEsV0FBWVYsS0FBS1csVUFBVThDLEdBQ3BELE1BTEk3RCxhQUFhYyxRQUFRLFdBQVlWLEtBQUtXLFVBQVUsQ0FBQyxJQUFJNUIsRUFBUUUsS0FLakUsRUUwRkF5RSxDQUFjekUsUUFDZHlELEVBQWdCekQsR0FBWSxJQU1oQyxNQUFNeUQsRUFBa0J6RCxJQUNwQixNQUFNMEQsRUFBaUJqQixTQUFTQyxlQUFlLFlBRXpDZ0MsRUFBaUJqQyxTQUFTSSxjQUFjLE1BQ3hDOEIsRUFBb0JsQyxTQUFTSSxjQUFjLFVBQzNDK0IsRUFBbUJuQyxTQUFTSSxjQUFjLE9BQzFDZ0MsRUFBY3BDLFNBQVNxQyxlQUFlOUUsR0FFeENBLEdGckVHVyxhQUFhQyxRQUFRLGtCRXNFeEJtRSxFQUFpQi9FLEVBQWEyRSxHQUVsQ0EsRUFBa0I1QixVQUFVQyxJQUFJLG9CQUNoQzJCLEVBQWtCekIsaUJBQWlCLFNBQVMsSUFBTTZCLEVBQWlCL0UsRUFBYTJFLEtBQ2hGRCxFQUFlM0IsVUFBVUMsSUFBSSxnQkFDN0IwQixFQUFlcEIsWUFBWXFCLEdBQzNCQyxFQUFpQjdCLFVBQVVDLElBQUkscUJBQy9CNEIsRUFBaUJ0QixZQUFZb0IsR0FDN0JFLEVBQWlCdEIsWUFBWTBCLEVBQXdCaEYsSUFFckQyRSxFQUFrQnJCLFlBQVl1QixHQUM5Qm5CLEVBQWVKLFlBQVlzQixFQUFpQixFQUkxQ0ksRUFBMkJoRixJQUM3QixNQUFNaUYsRUFBT3hDLFNBQVNJLGNBQWMsUUFDOUJxQyxFQUFZekMsU0FBU0ksY0FBYyxVQWF6QyxPQVpBb0MsRUFBSzNCLFlBQVk0QixHQUVqQkEsRUFBVWpDLFVBQVksU0FDdEJpQyxFQUFVZCxNQUFRcEUsRUFDbEJrRixFQUFVbkMsVUFBVUMsSUFBSSxzQkFDeEJrQyxFQUFVaEMsaUJBQWlCLFNBQVNlLElBQ2hDQSxFQUFNQyxpQkY3R2UsQ0FBQ2xFLElBQzFCLEdBQUdVLElBQWtCLENBRWpCLE1BQU15RSxFQURTcEUsS0FBS0MsTUFBTUwsYUFBYUMsUUFBUSxhQUNkSixRQUFRSixHQUFTQSxFQUFLSixhQUFlQSxJQUN0RVcsYUFBYWMsUUFBUSxXQUFZVixLQUFLVyxVQUFVeUQsR0FDcEQsR0V5R0lDLENBQWNwRixHQUNkcUYsSUFDQTVDLFNBQVNDLGVBQWUsa0JBQWtCQyxVQUFZLEdBQ3REWSxHQUF1QixJQUVwQjBCLENBQUksRUFJVEYsRUFBbUIsQ0FBQy9FLEVBQWEyRSxLQUNuQ1UsSUFDQVYsRUFBa0I1QixVQUFVb0IsT0FBTyxrQkFDbkNtQixFQUFzQnRGLEdGakhRLENBQUNBLElBQy9CVyxhQUFhYyxRQUFRLGdCQUFpQnpCLEVBQVksRUVpSGxEdUYsQ0FBbUJ2RixHQUNuQnFDLEVBQWFyQyxFQUFZLEVBSXZCcUYsRUFBc0IsS0FDeEJHLE1BQU1DLFVBQVVsRSxRQUFRbUUsS0FBS2pELFNBQVNrRCx1QkFBdUIscUJBQXFCQyxJQUM5RUEsRUFBVzdDLFVBQVU4QyxPQUFPLGlCQUFpQixHQUMvQyxFQUlBUCxFQUF5QnRGLElBQ0x5QyxTQUFTQyxlQUFlLGtCQUVoQ0MsVUFBWSx1K0JBZ0IrQjNDLHVJQUt6RCxNQUFNOEYsRUFBaUJyRCxTQUFTQyxlQUFlLG9CQUMvQ29ELEVBQWU1QyxpQkFBaUIsVUFBVWUsSUFFdEMsR0FEQUEsRUFBTUMsaUJBQ0ZwRSxFQUFRaUcsV0FBVzdFLEVBQW1CbEIsR0FBYyxJQUFJZ0csU0FBU0YsR0FBZ0JHLElBQUksVUFFckYsT0FEQTVCLE1BQU0saURBQ0MsRURuS08sRUFBQ1ksRUFBTWpGLEtBQzdCLE1BQU1rRyxFQUFXLElBQUlGLFNBQVNmLEdEdUJDLEVBQUM1RSxFQUFNTCxLQUN0QyxNQUFNbUcsRUFBY2pGLEVBQW1CbEIsR0FDdkNGLEVBQVFzRyxRQUFRRCxFQUFhOUYsR0FDN0JlLEVBQWtCK0UsRUFBWSxFQ3hCOUJFLENBRGEsSUFBSTFFLEVBQUt1RSxFQUFTRCxJQUFJLFNBQVVDLEVBQVNELElBQUksUUFBU0MsRUFBU0QsSUFBSSxZQUFhQyxFQUFTRCxJQUFJLGFBQ2hGakcsRUFBWSxFQ2tLbENzRyxDQUFXUixFQUFnQjlGLEdBQzNCcUMsRUFBYXJDLEdBQ2I4RixFQUFlUyxRQUNmQyxHQUFzQixJQUkxQi9ELFNBQVNDLGVBQWUsbUJBQW1CUSxpQkFBaUIsU0FBU2UsSUFDakVBLEVBQU1DLGlCQUNOc0MsR0FBc0IsSUFHMUIvRCxTQUFTQyxlQUFlLHVCQUF1QlEsaUJBQWlCLFNBQVNlLElBQ3JFQSxFQUFNQyxpQkFDTnNDLEdBQXNCLEdBQ3hCLEVBR0FBLEVBQXVCLEtBQ3pCLE1BQU1DLEVBQWdCaEUsU0FBU0MsZUFBZSxtQkFDeENvRCxFQUFpQnJELFNBQVNDLGVBQWUsb0JBQy9DK0QsRUFBYzFELFVBQVVvQixPQUFPLFVBQy9CMkIsRUFBZS9DLFVBQVVvQixPQUFPLFNBQVMsRUVuTjdDWixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3Byb2plY3RfbHMuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3RvZG8uanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL1VJLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy90b2RvX2xzLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgUHJvamVjdCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9qZWN0TmFtZSkge1xyXG4gICAgICAgIHRoaXMucHJvamVjdE5hbWUgPSBwcm9qZWN0TmFtZTtcclxuICAgICAgICB0aGlzLnRvZG9zID0gW107XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkcyBhIHRvZG8gdG8gdGhlIHByb2plY3RcclxuICAgIHN0YXRpYyBhZGRUb2RvID0gKHByb2osIHRvZG8pID0+IHtcclxuICAgICAgICBwcm9qLnRvZG9zLnB1c2godG9kbyk7XHJcbiAgICB9XHJcbiAgICAvLyBSZW1vdmVzIGEgdG9kbyB3aXRoIGEgZ2l2ZW4gbmFtZVxyXG4gICAgc3RhdGljIHJlbW92ZVRvZG8gPSAocHJvaiwgdG9kb05hbWUpID0+IHtcclxuICAgICAgICBwcm9qLnRvZG9zID0gcHJvai50b2Rvcy5maWx0ZXIoKHRvZG8pID0+IHRvZG8udGl0bGUgIT0gdG9kb05hbWUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJldHVybnMgdHJ1ZS9mYWxzZSBkZXBlbmRpbmcgb24gaWYgYSB0b2RvIGFscmVhZHkgZXhpc3RzIHdpdGggdGhlIHNhbWUgbmFtZVxyXG4gICAgc3RhdGljIHRvZG9FeGlzdHMgPSAocHJvaiwgdG9kb05hbWUpID0+IHtcclxuICAgICAgICBmb3IoY29uc3QgdG9kbyBvZiBwcm9qLnRvZG9zKSB7XHJcbiAgICAgICAgICAgIGlmICh0b2RvLnRpdGxlID09IHRvZG9OYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4vcHJvamVjdFwiO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2plY3RzRXhpc3RzID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwicHJvamVjdHNcIikgIT09IG51bGwgJiYgbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c1wiKS5sZW5ndGggPiAwOyAvLyBpcyByaWdodCBjb25kaXRpb24gdmFsaWQ/XHJcbn1cclxuXHJcbi8vIEFkZHMgbmV3IHByb2plY3QgdG8gbG9jYWwgc3RvcmFnZSBhbmQgZGlzcGxheXMgaXQgaW4gcHJvamVjdCB0YWJcclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVByb2plY3QgPSBwcm9qZWN0TmFtZSA9PiB7XHJcbiAgICBpZiAoIXByb2plY3RzRXhpc3RzKCkpIHtcclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3RzXCIsIEpTT04uc3RyaW5naWZ5KFtuZXcgUHJvamVjdChwcm9qZWN0TmFtZSldKSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCB1cGRhdGVkUHJvamVjdEFyciA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c1wiKSk7XHJcbiAgICAgICAgdXBkYXRlZFByb2plY3RBcnIucHVzaChuZXcgUHJvamVjdChwcm9qZWN0TmFtZSkpO1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdHNcIiwgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFByb2plY3RBcnIpKTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gUmV0dXJucyBhbiBhcnJheSBvZiB0aGUgbmFtZXMgb2YgZWFjaCBwcm9qZWN0XHJcbmV4cG9ydCBjb25zdCBnZXRQcm9qZWN0cyA9ICgpID0+IHtcclxuICAgIGlmIChwcm9qZWN0c0V4aXN0cygpKSB7XHJcbiAgICAgICAgY29uc3QgcHJvamVjdHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwicHJvamVjdHNcIikpO1xyXG4gICAgICAgIGNvbnN0IHByb2plY3ROYW1lcyA9IHByb2plY3RzLm1hcCgocHJvaikgPT4gcHJvai5wcm9qZWN0TmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIHByb2plY3ROYW1lcztcclxuICAgIH1cclxufVxyXG5cclxuLy8gUmV0dXJucyB0cnVlL2ZhbHNlIGRlcGVuZGluZyBvbiB3aGV0aGVyIGEgcHJvamVjdCB3aXRoIGEgZ2l2ZW4gbmFtZSBpcyBleGlzdHNcclxuZXhwb3J0IGNvbnN0IGNoZWNrSWZQcm9qZWN0RXhpc3RzID0gKHByb2plY3ROYW1lKSA9PiB7XHJcbiAgICBpZiAocHJvamVjdHNFeGlzdHMoKSkge1xyXG4gICAgICAgIHJldHVybiBnZXRQcm9qZWN0cygpLmluY2x1ZGVzKHByb2plY3ROYW1lKTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuLy8gRGVsZXRlcyBhIHNwZWNpZmllZCBwcm9qZWN0IGZyb20gbG9jYWwgc3RvcmFnZVxyXG5leHBvcnQgY29uc3QgZGVsZXRlUHJvamVjdCA9IChwcm9qZWN0TmFtZSkgPT4ge1xyXG4gICAgaWYocHJvamVjdHNFeGlzdHMoKSkge1xyXG4gICAgICAgIGxldCBwcm9qZWN0cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c1wiKSlcclxuICAgICAgICBjb25zdCB1cGRhdGVkUHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIoKHByb2opID0+IHByb2oucHJvamVjdE5hbWUgIT0gcHJvamVjdE5hbWUpO1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdHNcIiwgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFByb2plY3RzKSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIFN0b3JlcyBnaXZlbiBwcm9qZWN0IG5hbWUgYXMgdGhlIGFjdGl2ZSBwcm9qZWN0XHJcbmV4cG9ydCBjb25zdCBzdG9yZUFjdGl2ZVByb2plY3QgPSAocHJvamVjdE5hbWUpID0+IHtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYWN0aXZlUHJvamVjdFwiLCBwcm9qZWN0TmFtZSk7XHJcbn1cclxuXHJcbi8vIEdldHMgdGhlIGFjdGl2ZSBwcm9qZWN0IGZyb20gbG9jYWwgc3RvcmFnZVxyXG5leHBvcnQgY29uc3QgZ2V0QWN0aXZlUHJvamVjdCA9ICgpID0+IHtcclxuICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImFjdGl2ZVByb2plY3RcIik7XHJcbn1cclxuXHJcbi8vIEdldHMgYSBwcm9qZWN0IHdpdGggdGhlIGdpdmVuIG5hbWVcclxuZXhwb3J0IGNvbnN0IGdldFByb2plY3RXaXRoTmFtZSA9IChwcm9qZWN0TmFtZSkgPT4ge1xyXG4gICAgY29uc3QgcHJvamVjdHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwicHJvamVjdHNcIikpO1xyXG4gICAgcmV0dXJuIHByb2plY3RzLmZpbmQoKHByb2opID0+IHByb2oucHJvamVjdE5hbWUgPT0gcHJvamVjdE5hbWUpO1xyXG59XHJcblxyXG4vLyBBc3NpZ25zIGEgdG9kbyB0byBhIHByb2plY3QgLSBnaXZlbiB0aGF0IHByb2plY3QgZXhpc3RzIC0gYW5kIHVwZGF0ZXMgbG9jYWwgc3RvcmFnZVxyXG5leHBvcnQgY29uc3QgYXNzaWduVG9kb1RvUHJvamVjdCA9ICh0b2RvLCBwcm9qZWN0TmFtZSkgPT4ge1xyXG4gICAgY29uc3QgdXBkYXRlZFByb2ogPSBnZXRQcm9qZWN0V2l0aE5hbWUocHJvamVjdE5hbWUpO1xyXG4gICAgUHJvamVjdC5hZGRUb2RvKHVwZGF0ZWRQcm9qLCB0b2RvKTsgXHJcbiAgICB1cGRhdGVQcm9qZWN0TGlzdCh1cGRhdGVkUHJvaik7XHJcbn1cclxuXHJcbi8vIERlbGV0ZXMgc3BlY2lmaWMgdG9kbyBmcm9tIHNwZWNpZmllZCBwcm9qZWN0XHJcbmV4cG9ydCBjb25zdCBkZWxldGVUb2RvID0gKHByb2plY3ROYW1lLCB0b2RvVGl0bGUpID0+IHtcclxuICAgIGNvbnN0IHByb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInByb2plY3RzXCIpKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IHByb2ogb2YgcHJvamVjdHMpIHtcclxuICAgICAgICBpZiAocHJvai5wcm9qZWN0TmFtZSA9PSBwcm9qZWN0TmFtZSkge1xyXG4gICAgICAgICAgICBQcm9qZWN0LnJlbW92ZVRvZG8ocHJvaiwgdG9kb1RpdGxlKTtcclxuICAgICAgICAgICAgdXBkYXRlUHJvamVjdExpc3QocHJvaik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIFVwZGF0ZXMgbGlzdHMgb2YgcHJvamVjdHMgYnkgY2hhbmdpbmcgcHJvamVjdCB3aXRoIHVwZGF0ZWQgb25lXHJcbmNvbnN0IHVwZGF0ZVByb2plY3RMaXN0ID0gKHVwZGF0ZWRQcm9qZWN0KSA9PiB7XHJcbiAgICBjb25zdCBwcm9qZWN0cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c1wiKSk7XHJcblxyXG4gICAgcHJvamVjdHMuZm9yRWFjaChwcm9qID0+IHtcclxuICAgICAgICBpZiAocHJvai5wcm9qZWN0TmFtZSA9PSB1cGRhdGVkUHJvamVjdC5wcm9qZWN0TmFtZSkge1xyXG4gICAgICAgICAgICBwcm9qZWN0c1twcm9qZWN0cy5pbmRleE9mKHByb2opXSA9IHVwZGF0ZWRQcm9qZWN0O1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJwcm9qZWN0c1wiLCBKU09OLnN0cmluZ2lmeShwcm9qZWN0cykpO1xyXG59IiwiaW1wb3J0IHsgYXNzaWduVG9kb1RvUHJvamVjdCB9IGZyb20gXCIuL3Byb2plY3RfbHNcIjtcclxuXHJcbmNsYXNzIFRvZG8ge1xyXG4gICAgY29uc3RydWN0b3IodGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVEYXRlLCBwcmlvcml0eSkge1xyXG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XHJcbiAgICAgICAgdGhpcy5kdWVEYXRlID0gZHVlRGF0ZTtcclxuICAgICAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7XHJcbiAgICAgICAgdGhpcy5jb21wbGV0ZWQgPSBmYWxzZTsgLy8gTmVlZGVkP1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEZJWE1FIHByb3RvdHlwZXMgaW5zdGVhZD9cclxuXHJcbiAgICBnZXRUaXRsZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50aXRsZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXREZXNjcmlwdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kZXNjcmlwdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBnZXREdWVEYXRlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmR1ZURhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0UHJpb3JpdHkoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpb3JpdHk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNDb21wbGV0ZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcGxldGVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFdpbGwgc2V0dGVycyBiZSB1c2VkIGF0IGFueSBwb2ludD9cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVRvZG8gPSAoZm9ybSwgcHJvamVjdE5hbWUpID0+IHtcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGZvcm0pO1xyXG4gICAgY29uc3QgdG9kbyA9IG5ldyBUb2RvKGZvcm1EYXRhLmdldCgndGl0bGUnKSwgZm9ybURhdGEuZ2V0KCdkZXNjJyksIGZvcm1EYXRhLmdldCgnZHVlLWRhdGUnKSwgZm9ybURhdGEuZ2V0KCdwcmlvcml0eScpKTtcclxuICAgIGFzc2lnblRvZG9Ub1Byb2plY3QodG9kbywgcHJvamVjdE5hbWUpO1xyXG59IiwiaW1wb3J0IHsgY3JlYXRlUHJvamVjdCwgZ2V0UHJvamVjdHMsIHByb2plY3RzRXhpc3RzLCBjaGVja0lmUHJvamVjdEV4aXN0cywgZGVsZXRlUHJvamVjdCwgc3RvcmVBY3RpdmVQcm9qZWN0LCBnZXRBY3RpdmVQcm9qZWN0LCBkZWxldGVUb2RvLCBnZXRQcm9qZWN0V2l0aE5hbWUgfSBmcm9tIFwiLi9wcm9qZWN0X2xzXCI7XHJcbmltcG9ydCB7IGNyZWF0ZVRvZG8gfSBmcm9tIFwiLi90b2RvXCI7XHJcbmltcG9ydCB7IGdldFByb2plY3RUb2RvcyB9IGZyb20gXCIuL3RvZG9fbHNcIjtcclxuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuL3Byb2plY3RcIjtcclxuLy9cclxuLy8gIHB1dCBldmVudCBsaXN0ZW5lcnMgaGVyZSBvcj9cclxuLy9cclxuLy9cclxuLy9cclxuXHJcblxyXG4vLyBTaG91bGQgdGhlcmUgYmUgYSBtYWluIHNldCBwcm9qZWN0IGZ1bmN0aW9uIG9yP1xyXG5cclxuY29uc3QgZGlzcGxheVRvZG9zID0gKHByb2plY3ROYW1lKSA9PiB7XHJcbiAgICBjb25zdCB0b2RvcyA9IGdldFByb2plY3RUb2Rvcyhwcm9qZWN0TmFtZSk7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvZG9zXCIpO1xyXG4gICAgY29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XHJcblxyXG4gICAgdG9kb3MuZm9yRWFjaCh0b2RvID0+IHtcclxuICAgICAgICBjb25zdCB0b2RvRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgY29uc3QgZGVsZXRlVG9kb0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcblxyXG4gICAgICAgIHRvZG9FbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0b2RvLWl0ZW1cIik7XHJcbiAgICAgICAgZGVsZXRlVG9kb0J0bi5pbm5lclRleHQgPSBcIkRlbGV0ZSBQcm9qZWN0XCI7XHJcbiAgICAgICAgZGVsZXRlVG9kb0J0bi5jbGFzc0xpc3QuYWRkKFwiZGVsZXRlLXRvZG8tYnRuXCIpO1xyXG4gICAgICAgIGRlbGV0ZVRvZG9CdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgZGVsZXRlVG9kbyhwcm9qZWN0TmFtZSwgdG9kby50aXRsZSk7XHJcbiAgICAgICAgICAgIGRpc3BsYXlUb2Rvcyhwcm9qZWN0TmFtZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRvZG9FbGVtZW50LmlubmVySFRNTCA9IGBcclxuICAgICAgICAgICAgPGgzIGNsYXNzPVwidG9kby10aXRsZSBwcmlvcml0eS0ke3RvZG8ucHJpb3JpdHl9XCI+JHt0b2RvLnRpdGxlfTwvaDM+XHJcbiAgICAgICAgICAgIDxwIGNsYXNzPVwidG9kby1kZXNjXCI+JHt0b2RvLmRlc2NyaXB0aW9ufTwvcD5cclxuICAgICAgICAgICAgPHAgY2xhc3M9XCJ0b2RvLWRhdGVcIj5EdWU6ICR7dG9kby5kdWVEYXRlfTwvcD5cclxuICAgICAgICBgO1xyXG4gICAgICAgIHRvZG9FbGVtZW50LmFwcGVuZENoaWxkKGRlbGV0ZVRvZG9CdG4pO1xyXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0b2RvRWxlbWVudCk7XHJcbiAgICB9KVxyXG59XHJcblxyXG4vLyBVc2VkIG9uIGZpcnN0IHJlbG9hZCB0byBhZGQgdGhlIHByb2plY3RzIHRvIHRoZSBzaWRlYmFyXHJcbmV4cG9ydCBjb25zdCBkaXNwbGF5U3RvcmVkUHJvamVjdHMgPSAoKSA9PiB7XHJcbiAgICBpZiAocHJvamVjdHNFeGlzdHMoKSkge1xyXG4gICAgICAgIGNvbnN0IHByb2plY3RzID0gZ2V0UHJvamVjdHMoKTtcclxuICAgIFxyXG4gICAgICAgIGNsZWFyUHJvamVjdHNUYWIoKTtcclxuXHJcbiAgICAgICAgcHJvamVjdHMuZm9yRWFjaChwcm9qZWN0ID0+IHtcclxuICAgICAgICAgICAgYWRkUHJvamVjdFRvVGFiKHByb2plY3QpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBHZXRzIHJpZCBvZiBhbGwgdGhlIHByb2plY3QgSFRNTCAoTk9UIEZST00gTE9DQUwgU1RPUkFHRSlcclxuY29uc3QgY2xlYXJQcm9qZWN0c1RhYiA9ICgpID0+IHtcclxuICAgIGNvbnN0IGxpc3RPZlByb2plY3RzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9qZWN0c1wiKTtcclxuICAgIHdoaWxlIChsaXN0T2ZQcm9qZWN0cy5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgbGlzdE9mUHJvamVjdHMucmVtb3ZlQ2hpbGQobGlzdE9mUHJvamVjdHMuZmlyc3RDaGlsZCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIFRvZ2dsZXMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIGNyZWF0ZSBwcm9qZWN0IGJ1dHRvbiBhbmQgcHJvamVjdCBmb3JtXHJcbmZ1bmN0aW9uIHRvZ2dsZUJ0bkZvcm1WaXNpYmlsaXR5KCkge1xyXG4gICAgdG9nZ2xlQ3JlYXRlUHJvamVjdCgpO1xyXG4gICAgZGlzcGxheVByb2plY3RGb3JtKCk7XHJcbn1cclxuXHJcbi8vIENyZWF0ZSBwcm9qZWN0IGJ1dHRvbiBldmVudHNcclxuXHJcbmNvbnN0IGNyZWF0ZVByb2plY3RCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNyZWF0ZS1wcm9qZWN0LWJ0blwiKTtcclxuY3JlYXRlUHJvamVjdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdG9nZ2xlQnRuRm9ybVZpc2liaWxpdHkoKTtcclxufSk7XHJcblxyXG4vLyBEaXNwbGF5IHRoZSBmb3JtIGZvciBjcmVhdGluZyBhIHByb2plY3QgXHJcbmV4cG9ydCBjb25zdCB0b2dnbGVDcmVhdGVQcm9qZWN0ID0gKCkgPT4ge1xyXG4gICAgY3JlYXRlUHJvamVjdEJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZGVuXCIpO1xyXG59XHJcblxyXG4vLyBEaXNwbGF5IGFkZCBwcm9qZWN0IGZvcm1cclxuZXhwb3J0IGNvbnN0IGRpc3BsYXlQcm9qZWN0Rm9ybSA9ICgpID0+IHsgLy8gVE9ETyByZW5hbWUgdG8gdG9nZ2xlXHJcbiAgICBjb25zdCBhZGRQcm9qZWN0Rm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkLXByb2plY3QtZm9ybVwiKTtcclxuICAgIGFkZFByb2plY3RGb3JtLmNsYXNzTGlzdC50b2dnbGUoXCJoaWRkZW5cIik7XHJcbiAgICAvLyBNYWtlIHN1cmUgaW5wdXQgaXMgZW1wdHkgb25jZSBoaWRkZW5cclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvamVjdC1pbnB1dFwiKS52YWx1ZSA9IFwiXCI7XHJcbn07XHJcblxyXG4vLyBDYW5jZWwgcHJvamVjdCBidG5cclxuY29uc3QgY2FuY2VsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW5jZWxcIik7XHJcbmNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdG9nZ2xlQnRuRm9ybVZpc2liaWxpdHkpO1xyXG5cclxuLy8gQWRkIHByb2plY3QgYnV0dG9uIGZ1bmN0aW9uYWxpdHlcclxuY29uc3QgYWRkUHJvamVjdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkLXByb2plY3QtYnRuXCIpO1xyXG5hZGRQcm9qZWN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjb25zdCBwcm9qZWN0TmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvamVjdC1pbnB1dFwiKS52YWx1ZTtcclxuICAgIGlmIChwcm9qZWN0TmFtZSA9PSBcIlwiKSB7XHJcbiAgICAgICAgYWxlcnQoXCJTb3JyeSwgcGxlYXNlIGVudGVyIGEgdmFsaWQgcHJvamVjdCBuYW1lXCIpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0gZWxzZSBpZiAoY2hlY2tJZlByb2plY3RFeGlzdHMocHJvamVjdE5hbWUpKSB7XHJcbiAgICAgICAgYWxlcnQoXCJTb3JyeSwgYSBwcm9qZWN0IHdpdGggdGhhdCBuYW1lIGFscmVhZHkgZXhpc3RzIVwiKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICB0b2dnbGVCdG5Gb3JtVmlzaWJpbGl0eSgpO1xyXG4gICAgY3JlYXRlUHJvamVjdChwcm9qZWN0TmFtZSk7XHJcbiAgICBhZGRQcm9qZWN0VG9UYWIocHJvamVjdE5hbWUpO1xyXG59KTtcclxuXHJcbi8vIFByb2plY3QgdGFiIGZ1bmN0aW9uYWxpdHlcclxuXHJcbi8vIEFkZHMgcHJvamVjdCB0byBwcm9qZWN0IHRhYlxyXG5jb25zdCBhZGRQcm9qZWN0VG9UYWIgPSBwcm9qZWN0TmFtZSA9PiB7XHJcbiAgICBjb25zdCBsaXN0T2ZQcm9qZWN0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvamVjdHNcIik7XHJcbiAgICBcclxuICAgIGNvbnN0IHByb2plY3RFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xyXG4gICAgY29uc3QgcHJvamVjdE5hbWVCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgY29uc3QgcHJvamVjdENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICBjb25zdCBwcm9qZWN0VGV4dCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHByb2plY3ROYW1lKTtcclxuXHJcbiAgICBpZiAocHJvamVjdE5hbWUgPT0gZ2V0QWN0aXZlUHJvamVjdCgpKSB7XHJcbiAgICAgICAgc2V0QWN0aXZlUHJvamVjdChwcm9qZWN0TmFtZSwgcHJvamVjdE5hbWVCdXR0b24pO1xyXG4gICAgfVxyXG4gICAgcHJvamVjdE5hbWVCdXR0b24uY2xhc3NMaXN0LmFkZChcInByb2plY3QtbmFtZS1idG5cIik7XHJcbiAgICBwcm9qZWN0TmFtZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gc2V0QWN0aXZlUHJvamVjdChwcm9qZWN0TmFtZSwgcHJvamVjdE5hbWVCdXR0b24pKTtcclxuICAgIHByb2plY3RFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LW5hbWVcIik7XHJcbiAgICBwcm9qZWN0RWxlbWVudC5hcHBlbmRDaGlsZChwcm9qZWN0TmFtZUJ1dHRvbik7XHJcbiAgICBwcm9qZWN0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtY29udGFpbmVyJyk7XHJcbiAgICBwcm9qZWN0Q29udGFpbmVyLmFwcGVuZENoaWxkKHByb2plY3RFbGVtZW50KTtcclxuICAgIHByb2plY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlRGVsZXRlUHJvamVjdEZvcm0ocHJvamVjdE5hbWUpKTtcclxuXHJcbiAgICBwcm9qZWN0TmFtZUJ1dHRvbi5hcHBlbmRDaGlsZChwcm9qZWN0VGV4dCk7XHJcbiAgICBsaXN0T2ZQcm9qZWN0cy5hcHBlbmRDaGlsZChwcm9qZWN0Q29udGFpbmVyKTtcclxufVxyXG5cclxuLy8gRGVsZXRlIHByb2plY3QgZm9ybSAoZm4gcmV0dXJucyBhIGh0bWwgZm9ybSlcclxuY29uc3QgY3JlYXRlRGVsZXRlUHJvamVjdEZvcm0gPSAocHJvamVjdE5hbWUpID0+IHtcclxuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKTtcclxuICAgIGNvbnN0IGRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7ICAgIFxyXG4gICAgZm9ybS5hcHBlbmRDaGlsZChkZWxldGVCdG4pO1xyXG5cclxuICAgIGRlbGV0ZUJ0bi5pbm5lclRleHQgPSBcIkRlbGV0ZVwiO1xyXG4gICAgZGVsZXRlQnRuLnZhbHVlID0gcHJvamVjdE5hbWU7XHJcbiAgICBkZWxldGVCdG4uY2xhc3NMaXN0LmFkZChcImRlbGV0ZS1wcm9qZWN0LWJ0blwiKTtcclxuICAgIGRlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZXZlbnQgPT4ge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgZGVsZXRlUHJvamVjdChwcm9qZWN0TmFtZSk7XHJcbiAgICAgICAgY2xlYXJBY3RpdmVQcm9qZWN0cygpO1xyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9kby1jb250YWluZXJcIikuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICBkaXNwbGF5U3RvcmVkUHJvamVjdHMoKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZvcm07XHJcbn1cclxuXHJcbi8vIHNob3VsZCBzZXQgdmFsdWUgb2Ygc3VibWl0IHRvIGN1cnJlbnQgYWN0aXZlIHByb2plY3RcclxuY29uc3Qgc2V0QWN0aXZlUHJvamVjdCA9IChwcm9qZWN0TmFtZSwgcHJvamVjdE5hbWVCdXR0b24pID0+IHtcclxuICAgIGNsZWFyQWN0aXZlUHJvamVjdHMoKTtcclxuICAgIHByb2plY3ROYW1lQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJhY3RpdmUtcHJvamVjdFwiKTtcclxuICAgIGFkZFRvZG9Gb3Jtc0NvbnRhaW5lcihwcm9qZWN0TmFtZSk7XHJcbiAgICBzdG9yZUFjdGl2ZVByb2plY3QocHJvamVjdE5hbWUpO1xyXG4gICAgZGlzcGxheVRvZG9zKHByb2plY3ROYW1lKTtcclxufVxyXG5cclxuLy8gR2V0cyByaWQgb2YgdGhlIGFjdGl2ZSBwcm9qZWN0IGNsYXNzIGZyb20gcHJvamVjdCBidXR0b25zXHJcbmNvbnN0IGNsZWFyQWN0aXZlUHJvamVjdHMgPSAoKSA9PiB7XHJcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJwcm9qZWN0LW5hbWUtYnRuXCIpLCBwcm9qZWN0QnRuID0+IHtcclxuICAgICAgICBwcm9qZWN0QnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmUtcHJvamVjdFwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBBZGRzIHRoZSBjcmVhdGUgdG9kbyBmb3JtcyB0byB0aGUgdG9kbyBjb250YWluZXJcclxuY29uc3QgYWRkVG9kb0Zvcm1zQ29udGFpbmVyID0gKHByb2plY3ROYW1lKSA9PiB7XHJcbiAgICBjb25zdCB0b2RvQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b2RvLWNvbnRhaW5lclwiKTtcclxuXHJcbiAgICB0b2RvQ29udGFpbmVyLmlubmVySFRNTCA9IGBcclxuICAgICAgICA8ZGl2IGlkPVwidG9kb3NcIj48L2Rpdj5cclxuICAgICAgICA8YnV0dG9uIGlkPVwiY3JlYXRlLXRvZG8tYnRuXCI+Q3JlYXRlIFRvZG88L2J1dHRvbj5cclxuICAgICAgICA8Zm9ybSBpZD1cImNyZWF0ZS10b2RvLWZvcm1cIiBjbGFzcz1cImhpZGRlblwiPlxyXG4gICAgICAgICAgICA8bGFiZWwgZm9yPVwidG9kby1mb3JtLXRpdGxlXCI+VG9kbyBOYW1lPC9sYWJlbD5cclxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmFtZT1cInRpdGxlXCIgaWQ9XCJ0b2RvLWZvcm0tdGl0bGVcIiBwbGFjZWhvbGRlcj1cIk5hbWUgb2YgdG9kb1wiIHJlcXVpcmVkPlxyXG4gICAgICAgICAgICA8bGFiZWwgZm9yPVwidG9kby1mb3JtLWRlc2NcIj5EZXNjcmlwdGlvbjwvbGFiZWw+XHJcbiAgICAgICAgICAgIDx0ZXh0YXJlYSBuYW1lPVwiZGVzY1wiIGlkPVwidG9kby1mb3JtLWRlc2NcIiBjb2xzPVwiMzBcIiByb3dzPVwiMTBcIiBwbGFjZWhvbGRlcj1cIk9wdGlvbmFsIGRlc2NyaXB0aW9uLi4uXCI+PC90ZXh0YXJlYT5cclxuICAgICAgICAgICAgPGxhYmVsIGZvcj1cInRvZG8tcHJpb3JpdHlcIj5Qcmlvcml0eTwvbGFiZWw+XHJcbiAgICAgICAgICAgIDxzZWxlY3QgbmFtZT1cInByaW9yaXR5XCIgaWQ9XCJ0b2RvLXByaW9yaXR5XCIgcmVxdWlyZWQ+XHJcbiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwibG93XCI+TG93PC9vcHRpb24+XHJcbiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwibWVkaXVtXCI+TWVkaXVtPC9vcHRpb24+XHJcbiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiaGlnaFwiPkhpZ2g8L29wdGlvbj5cclxuICAgICAgICAgICAgPC9zZWxlY3Q+XHJcbiAgICAgICAgICAgIDxsYWJlbCBmb3I9XCJ0b2RvLWRhdGUtaW5wdXRcIj5EdWUgRGF0ZTwvbGFiZWw+XHJcbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiZGF0ZVwiIG5hbWU9XCJkdWUtZGF0ZVwiIGlkPVwidG9kby1kYXRlLWlucHV0XCIgcmVxdWlyZWQ+XHJcbiAgICAgICAgICAgIDxidXR0b24gdHlwZT1cInN1Ym1pdFwiIGlkPVwiYWRkLXRvZG8tYnRuXCIgdmFsdWU9XCIke3Byb2plY3ROYW1lfVwiPkNyZWF0ZSBUb2RvPC9idXR0b24+XHJcbiAgICAgICAgICAgIDxidXR0b24gaWQ9XCJhZGQtdG9kby1jYW5jZWwtYnRuXCIgY2xhc3M9XCJkZWxldGUtdG9kby1idG5cIj5DYW5jZWw8L2J1dHRvbj5cclxuICAgICAgICA8L2Zvcm0+XHJcbiAgICBgO1xyXG4gICAgXHJcbiAgICBjb25zdCBjcmVhdGVUb2RvRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3JlYXRlLXRvZG8tZm9ybVwiKTtcclxuICAgIGNyZWF0ZVRvZG9Gb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZXZlbnQgPT4ge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgaWYgKFByb2plY3QudG9kb0V4aXN0cyhnZXRQcm9qZWN0V2l0aE5hbWUocHJvamVjdE5hbWUpLCBuZXcgRm9ybURhdGEoY3JlYXRlVG9kb0Zvcm0pLmdldChcInRpdGxlXCIpKSkge1xyXG4gICAgICAgICAgICBhbGVydChcIlNvcnJ5LCBhIHRvZG8gd2l0aCB0aGlzIG5hbWUgYWxyZWFkeSBleGlzdHMhXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNyZWF0ZVRvZG8oY3JlYXRlVG9kb0Zvcm0sIHByb2plY3ROYW1lKTtcclxuICAgICAgICBkaXNwbGF5VG9kb3MocHJvamVjdE5hbWUpO1xyXG4gICAgICAgIGNyZWF0ZVRvZG9Gb3JtLnJlc2V0KCk7XHJcbiAgICAgICAgdG9nZ2xlQ3JlYXRlVG9kb0Zvcm0oKTtcclxuICAgIH0pXHJcblxyXG4gICAgLy8gVE9ETyAtIFBVVCBJTiBTRVBBUkFURSBGVU5DVElPTlxyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjcmVhdGUtdG9kby1idG5cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGV2ZW50ID0+IHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRvZ2dsZUNyZWF0ZVRvZG9Gb3JtKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZC10b2RvLWNhbmNlbC1idG5cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGV2ZW50ID0+IHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRvZ2dsZUNyZWF0ZVRvZG9Gb3JtKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuY29uc3QgdG9nZ2xlQ3JlYXRlVG9kb0Zvcm0gPSAoKSA9PiB7XHJcbiAgICBjb25zdCBjcmVhdGVUb2RvQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjcmVhdGUtdG9kby1idG5cIik7XHJcbiAgICBjb25zdCBjcmVhdGVUb2RvRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3JlYXRlLXRvZG8tZm9ybVwiKTtcclxuICAgIGNyZWF0ZVRvZG9CdG4uY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKTtcclxuICAgIGNyZWF0ZVRvZG9Gb3JtLmNsYXNzTGlzdC50b2dnbGUoXCJoaWRkZW5cIik7XHJcbn0iLCIvLyBHZXRzIHRvZG9zIGZyb20gbG9jYWwgc3RvcmFnZSBmb3IgYSBnaXZlbiBwcm9qZWN0XHJcbmV4cG9ydCBjb25zdCBnZXRQcm9qZWN0VG9kb3MgPSAocHJvamVjdE5hbWUpID0+IHtcclxuICAgIGNvbnN0IHByb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInByb2plY3RzXCIpKTtcclxuICAgIGxldCB0b2RvcztcclxuICAgIHByb2plY3RzLmZvckVhY2gocHJvamVjdCA9PiB7XHJcbiAgICAgICAgaWYgKHByb2plY3QucHJvamVjdE5hbWUgPT0gcHJvamVjdE5hbWUpIHtcclxuICAgICAgICAgICAgdG9kb3MgPSBwcm9qZWN0LnRvZG9zO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRvZG9zO1xyXG59IiwiLy8gaW1wb3J0IHsgZm9ybWF0IH0gZnJvbSAnZGF0ZS1mbnMnO1xyXG5cclxuLy8gY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xyXG4vLyBjb25zdCBmb3JtYXR0ZWREYXRlID0gZm9ybWF0KGN1cnJlbnREYXRlLCAnTU1NTSBkbywgeXl5eScpO1xyXG5cclxuLy8gY29uc29sZS5sb2coYFRoZSBjdXJyZW50IGRhdGUgaXMgJHtmb3JtYXR0ZWREYXRlfWApO1xyXG5cclxuLy8gVE9ETyBTRVBBUkFURSBVSSBGSUxFU1xyXG5cclxuLy8gVE9ETy0gLW9yZ2FuaXNlIGV2ZW50IGxpc3RlbnJzXHJcblxyXG5pbXBvcnQgeyBkaXNwbGF5U3RvcmVkUHJvamVjdHMgfSBmcm9tIFwiLi9VSVwiO1xyXG5kaXNwbGF5U3RvcmVkUHJvamVjdHMoKTsiXSwibmFtZXMiOlsiUHJvamVjdCIsImNvbnN0cnVjdG9yIiwicHJvamVjdE5hbWUiLCJ0aGlzIiwidG9kb3MiLCJzdGF0aWMiLCJwcm9qIiwidG9kbyIsInB1c2giLCJ0b2RvTmFtZSIsImZpbHRlciIsInRpdGxlIiwicHJvamVjdHNFeGlzdHMiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwibGVuZ3RoIiwiZ2V0UHJvamVjdHMiLCJKU09OIiwicGFyc2UiLCJtYXAiLCJnZXRQcm9qZWN0V2l0aE5hbWUiLCJmaW5kIiwidXBkYXRlUHJvamVjdExpc3QiLCJ1cGRhdGVkUHJvamVjdCIsInByb2plY3RzIiwiZm9yRWFjaCIsImluZGV4T2YiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwiVG9kbyIsImRlc2NyaXB0aW9uIiwiZHVlRGF0ZSIsInByaW9yaXR5IiwiY29tcGxldGVkIiwiZ2V0VGl0bGUiLCJnZXREZXNjcmlwdGlvbiIsImdldER1ZURhdGUiLCJnZXRQcmlvcml0eSIsImlzQ29tcGxldGVkIiwiZGlzcGxheVRvZG9zIiwicHJvamVjdCIsImdldFByb2plY3RUb2RvcyIsImNvbnRhaW5lciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJpbm5lckhUTUwiLCJ0b2RvRWxlbWVudCIsImNyZWF0ZUVsZW1lbnQiLCJkZWxldGVUb2RvQnRuIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5uZXJUZXh0IiwiYWRkRXZlbnRMaXN0ZW5lciIsInRvZG9UaXRsZSIsInJlbW92ZVRvZG8iLCJkZWxldGVUb2RvIiwiYXBwZW5kQ2hpbGQiLCJkaXNwbGF5U3RvcmVkUHJvamVjdHMiLCJjbGVhclByb2plY3RzVGFiIiwiYWRkUHJvamVjdFRvVGFiIiwibGlzdE9mUHJvamVjdHMiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJ0b2dnbGVCdG5Gb3JtVmlzaWJpbGl0eSIsInRvZ2dsZUNyZWF0ZVByb2plY3QiLCJkaXNwbGF5UHJvamVjdEZvcm0iLCJjcmVhdGVQcm9qZWN0QnRuIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInRvZ2dsZSIsInZhbHVlIiwiYWxlcnQiLCJpbmNsdWRlcyIsImNoZWNrSWZQcm9qZWN0RXhpc3RzIiwidXBkYXRlZFByb2plY3RBcnIiLCJjcmVhdGVQcm9qZWN0IiwicHJvamVjdEVsZW1lbnQiLCJwcm9qZWN0TmFtZUJ1dHRvbiIsInByb2plY3RDb250YWluZXIiLCJwcm9qZWN0VGV4dCIsImNyZWF0ZVRleHROb2RlIiwic2V0QWN0aXZlUHJvamVjdCIsImNyZWF0ZURlbGV0ZVByb2plY3RGb3JtIiwiZm9ybSIsImRlbGV0ZUJ0biIsInVwZGF0ZWRQcm9qZWN0cyIsImRlbGV0ZVByb2plY3QiLCJjbGVhckFjdGl2ZVByb2plY3RzIiwiYWRkVG9kb0Zvcm1zQ29udGFpbmVyIiwic3RvcmVBY3RpdmVQcm9qZWN0IiwiQXJyYXkiLCJwcm90b3R5cGUiLCJjYWxsIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInByb2plY3RCdG4iLCJyZW1vdmUiLCJjcmVhdGVUb2RvRm9ybSIsInRvZG9FeGlzdHMiLCJGb3JtRGF0YSIsImdldCIsImZvcm1EYXRhIiwidXBkYXRlZFByb2oiLCJhZGRUb2RvIiwiYXNzaWduVG9kb1RvUHJvamVjdCIsImNyZWF0ZVRvZG8iLCJyZXNldCIsInRvZ2dsZUNyZWF0ZVRvZG9Gb3JtIiwiY3JlYXRlVG9kb0J0biJdLCJzb3VyY2VSb290IjoiIn0=